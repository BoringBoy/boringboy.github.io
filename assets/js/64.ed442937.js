(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{399:function(s,e,a){"use strict";a.r(e);var t=a(7),n=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"oracle数据库的逻辑备份与恢复"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#oracle数据库的逻辑备份与恢复"}},[s._v("#")]),s._v(" oracle数据库的逻辑备份与恢复")]),s._v(" "),e("h2",{attrs:{id:"引言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#引言"}},[s._v("#")]),s._v(" 引言")]),s._v(" "),e("ul",[e("li",[s._v("为什么要备份？")])]),s._v(" "),e("p",[s._v("随着计算机的不断发展，数据安全显得愈发重要。一旦造成数据丢失，将会付出巨大的工作量去弥补数据，也可能因此造成不可挽回的损失。因此，无论是数据库管理员或是与数据交互的维护人员，都必须要学习备份知识，做好数据备份工作，以防备可能出现的数据丢失/损坏风险。")]),s._v(" "),e("ul",[e("li",[s._v("何为逻辑备份？")])]),s._v(" "),e("blockquote",[e("p",[s._v("逻辑备份是指从数据库中导出数据并写入一个输出文件。逻辑备份只能用来对数据库进行逻辑恢复，即数据导入，而不能按数据库原来的存储特征进行物理恢复。逻辑备份可以使用exp命令来完成，逻辑导入可以使用imp命令来完成。")])]),s._v(" "),e("h2",{attrs:{id:"备份命令的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#备份命令的使用"}},[s._v("#")]),s._v(" 备份命令的使用")]),s._v(" "),e("h3",{attrs:{id:"导出-exp-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导出-exp-命令"}},[s._v("#")]),s._v(" 导出(exp 命令)")]),s._v(" "),e("ol",{attrs:{start:"0"}},[e("li",[e("p",[s._v("查看用户表信息\n"),e("code",[s._v("select * from tab;")])])]),s._v(" "),e("li",[e("p",[s._v("导出表数据")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("## 命令示例\nexp dxzh/duxingzhe@192.168.0.200:1521/orcl owner=dxzh file=x:\\database\\Oracle\\\\data\\\\exp\\\\1019\\\\userinfo.dmp log=X:\\database\\Oracle\\\\logs\\\\exp\\\\1019\\\\exp.log\n\n## 示例中scott表示用户名,tiger表示用户口令\n\n#导出一张表中的数据\nexp scott/tiger tables=emp file=/home/oracle/bak/emp.dmp buffer=1000000\n\n#导出多张表中的数据\nexp scott/tiger tables=emp,dept file=/home/oracle/bak/emp_dept.dmp buffer=1000000\n\n#导出emp表中的10部门数据\nexp scott/tiger tables=emp query=\\'where deptno=10\\' file=/home/oracle/bak/emp10.dmp buffer=1000000\n\n#导出emp表中的10部门数据\nexp scott/tiger tables=emp query=\\\"where ename like \\'%M%\\'\\\" file=/home/oracle/bak/emp_ename.dmp buffer=1000000\n\n#导出表结构\nexp scott/tiger tables=emp,dept,salgrade rows=N file=/home/oracle/bak/scott_stru.dmp\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("导出用户数据")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("#scott用户导出自己的数据\nexp scott/tiger owner=scott file=/home/oracle/bak/scott.dmp buffer=1048576\n\n#system用户导出其它用户的数据\nexp system/system owner=scott,jack file=/home/oracle/bak/user.dmp buffer=1048576\n\n#导出整个数据库中的数据\nexp system/system full=y file=/home/oracle/bak/full.dmp buffer=1048576\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"参数作用说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数作用说明"}},[s._v("#")]),s._v(" 参数作用说明")]),s._v(" "),e("ul",[e("li",[s._v("FULL")])]),s._v(" "),e("blockquote",[e("p",[s._v("导出整个数据库，只有拥有exp_full_database角色的用户或者特权用户如sys，system等才能进行全库导出.full=y 或full=n")])]),s._v(" "),e("ul",[e("li",[s._v("BUFFER")])]),s._v(" "),e("blockquote",[e("p",[s._v("指定数据缓冲区大小，单位为字节，不能写成buffer=1m的形式。(buffer=n   #n为字节数)")])]),s._v(" "),e("ul",[e("li",[s._v("OWNER")])]),s._v(" "),e("blockquote",[e("p",[s._v("需要导出的用户，如果需要导出多个用户可以使用逗号隔开。(说明：普通用户只能导出自己的数据，不能导出其它用户的数据。只有system用户才能导出其它用户的数据。)")])]),s._v(" "),e("ul",[e("li",[s._v("FILE")])]),s._v(" "),e("blockquote",[e("p",[s._v("指定输出文件")])]),s._v(" "),e("ul",[e("li",[s._v("TABLES")])]),s._v(" "),e("blockquote",[e("p",[s._v("指定需要导出的表，如果需要导出多个表可以使用逗号隔开。")])]),s._v(" "),e("ul",[e("li",[s._v("ROWS")])]),s._v(" "),e("blockquote",[e("p",[s._v("指定导出后的表是否带数据（取值为N或Y，默认为Y）")])]),s._v(" "),e("ul",[e("li",[s._v("QUERY")])]),s._v(" "),e("blockquote",[e("p",[s._v("导出表时指定条件以导出部分数据。")])]),s._v(" "),e("h3",{attrs:{id:"导入-imp命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导入-imp命令"}},[s._v("#")]),s._v(" 导入(imp命令)")]),s._v(" "),e("ul",[e("li",[s._v("导入命令及其示例")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("一、导入e01和e02表\nimp scott/tiger tables=e01,e02 file=/home/oracle/bak/e01_02.dmp buffer=1048576\n\n二、通过数据导入追加数据\n#导出e02表中的10部门员工\nexp scott/tiger tables=e02 query=\\'where deptno=10\\' file=/home/oracle/bak/e02_10.dmp buffer=1048576\n\n#把导出的10部门的员工追加到e02表中\nimp scott/tiger tables=e02 ignore=y file=/home/oracle/bak/e02_10.dmp buffer=1048576\n\n三、导出并恢复一个用户下的所有数据\n#导出scott用户下的所有数据\nexp scott/tiger owner=scott file=/home/oracle/bak/scott.dmp buffer=1048576\n\n#导入scott用户数据\nimp scott/tiger full=y file=/home/oracle/bak/scott.dmp buffer=1048576\n\n四、导出并恢复多个用户的数据（此操作必须有system用户完成）\n#导出scott用户和jack用户的数据\nexp system/system owner=scott,jack file=/home/oracle/bak/scott_jack.dmp buffer=1048576\n\n#导入scott用户和jack用户的数据\nimp system/system full=y file=/home/oracle/bak/scott_jack.dmp buffer=1048576\n\n五、把一个用户的所有数据导入到另一个用户\n#导出scott用户的数据\nexp scott/tiger owner=scott file=/home/oracle/bak/scott.dmp buffer=1048576\n\n#把scott用户的数据导入到jack用户\nimp system/system fromuser=scott touser=jack file=/home/oracle/bak/scott.dmp buffer=1048576\n\n六、把一个用户的部分数据导入到另一个用户\n#导出scott用户的数据\nexp scott/tiger owner=scott file=/home/oracle/bak/scott.dmp buffer=1048576\n\n#把scott用户的e01和e02表导入到jack用户\nimp system/system fromuser=scott touser=jack tables=e01,e02 file=/home/oracle/bak/scott.dmp buffer=1048576\n\n七、恢复整个数据库中的数据\nimp system/system full=y file=/home/oracle/bak/full.dmp buffer=1048576\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br")])]),e("h4",{attrs:{id:"参数作用说明-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数作用说明-2"}},[s._v("#")]),s._v(" 参数作用说明")]),s._v(" "),e("blockquote",[e("p",[s._v("imp命令的参数和exp命令大部分是相同的，USERID、TABLES、OWNER、FILE、BUFFER等参数的含义和exp命令完全相同。")])]),s._v(" "),e("ul",[e("li",[s._v("只导入数据")])]),s._v(" "),e("blockquote",[e("p",[s._v("imp有一个参数，data_only， 默认为N,需要导入数据时添加data_only=y 即可")])]),s._v(" "),e("ul",[e("li",[s._v("ignore参数")])]),s._v(" "),e("blockquote",[e("p",[s._v("(1)oracle imp 导入可以使用 ignore=y 参数进行覆盖数据库。如果不使用 ignore=y  参数在进行imp 导入时，就会对已经存在的表就不会进行导入，如果加上ignore=y 参数就会对已经存在的表中没有的记录进行更新，但对已经存在记录不会进行覆盖修改。")])]),s._v(" "),e("blockquote",[e("p",[s._v("(2)在恢复数据的过程中，当导入某个表时，如果该表已经存在，则根据ignore参数的设置来决定如何操作。\n若ignore=y，不执行CREATE TABLE语句，直接将数据插入到表中，如果插入的记录违背了约束条件，比如主键约束，唯一索引等，则出错的记录不会插入，但合法的记录会添加到表中。\n若ignore=n，不执行CREATE TABLE语句，同时也不会将数据插入到表中，而是忽略该表的错误，继续导入下一个表。")])])])}),[],!1,null,null,null);e.default=n.exports}}]);